<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Turnierbaum – Warhammer 40k PvP Clash</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:#000; color:#eee; }
.topnav { display:flex; justify-content:center; background:#111; padding:0.8rem; gap:1.5rem; border-bottom:2px solid #ff4f4f; }
.topnav a { color:#eee; text-decoration:none; font-weight:bold; transition:0.2s; }
.topnav a:hover { color:#ff4f4f; }

.hero { position:relative; height:200px; display:flex; align-items:center; justify-content:center; text-align:center; background:#222; color:#fff; }
.hero .overlay { position:absolute; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.6);}
.hero__content { position:relative; z-index:2; text-shadow:2px 2px 8px #000; }

.container { padding:1rem; display:flex; justify-content:center; flex-direction:column; gap:2rem; }
.bracket-container { display:flex; flex-direction:column; align-items:center; gap:3rem; width:100%; max-width:100%; }

.section-title { font-size:1.5rem; font-weight:bold; margin-bottom:1rem; text-align:center; color:#ff4f4f; }
.bracket { display:flex; flex-direction:row; gap:2rem; flex:0 0 auto; }
.round { display:flex; flex-direction:column; justify-content:center; gap:2.5rem; min-width:120px; position:relative; }
.match-pair { display:flex; flex-direction:column; gap:0.3rem; position:relative; }
.team-box { background:#111; border:2px solid #ff4f4f; padding:0.5rem 0.8rem; border-radius:8px; text-align:center; min-width:100px; font-weight:bold;}
.team-name { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

.center-final { display:flex; flex-direction:column; justify-content:center; align-items:center; gap:1rem; min-width:180px; position:relative;}
.final-box { background:#222; border:2px solid #ff4f4f; padding:1rem 2rem; border-radius:10px; text-align:center; min-width:160px; font-weight:bold; position:relative; z-index:1;}
.muted { color:#aaa; font-size:0.9rem; }

@media(max-width:768px){
  .round { gap:2rem; min-width:80px; }
  .team-box { min-width:70px; padding:0.3rem 0.5rem; font-size:0.85rem; }
  .hero { height:150px; }
}

footer { text-align:center; padding:1rem; background:#111; border-top:2px solid #ff4f4f; margin-top:2rem;}
</style>
</head>
<body>

<nav class="topnav">
  <a href="#">Start</a>
  <a href="#">Überblick</a>
  <a href="#">Regeln & Ablauf</a>
  <a href="#">Turnierbaum</a>
</nav>

<header class="hero">
  <div class="overlay"></div>
  <div class="hero__content">
    <h1>Turnierbaum</h1>
    <p>Doppel-Eliminierung – Teams aus dem Sheet</p>
  </div>
</header>

<main class="container">
  <div class="bracket-container">

    <div>
      <div class="section-title">Winner Bracket</div>
      <div class="bracket" id="winner-bracket"></div>
    </div>

    <div class="center-final">
      <div class="final-box">Finale</div>
      <div class="muted">Grand Champion</div>
    </div>

    <div>
      <div class="section-title">Loser Bracket</div>
      <div class="bracket" id="loser-bracket"></div>
    </div>

  </div>
</main>

<footer>© 2025 Warhammer 40k PvP Clash – Alle Rechte vorbehalten.</footer>

<script>
// --- Google Sheet Setup ---
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRYv16SEpDn7IxjQVVJ3BKDwuEgYuCtWypJbKGe62pnuOpGH43ke2O-xWU96-EaCXAyGWLrJ23iaJuY/pub?output=csv";

// CSV parse
function parseCSV(csv){
  return csv.split('\n').map(row => row.split(',').map(cell => cell.replace(/"/g,'').trim()));
}

// Team Box erstellen
function createTeamBox(teamName){
  const div = document.createElement("div");
  div.classList.add("team-box");
  div.innerHTML = `<div class="team-name">${teamName || "TBD"}</div>`;
  return div;
}

// Match erstellen
function createMatchPair(team1, team2){
  const div = document.createElement("div");
  div.classList.add("match-pair");
  div.appendChild(createTeamBox(team1));
  div.appendChild(createTeamBox(team2));
  return div;
}

// Bracket erstellen
function generateBracket(container, data, mapping){
  container.innerHTML = '';
  mapping.forEach(roundMapping => {
    const roundDiv = document.createElement("div");
    roundDiv.classList.add("round");
    roundMapping.forEach(cell => {
      const teamName = data[cell.row] ? data[cell.row][cell.col] : "TBD";
      const matchDiv = createMatchPair(teamName, ""); // leeres zweites Feld für Optik
      roundDiv.appendChild(matchDiv);
    });
    container.appendChild(roundDiv);
  });
}

// Mapping: jedes Kästchen ist eine bestimmte Zelle im Sheet
const winnerMapping = [
  // Runde 1: 8 Matches
  [{row:0,col:0},{row:0,col:1},{row:0,col:2},{row:0,col:3},{row:0,col:4},{row:0,col:5},{row:0,col:6},{row:0,col:7}]
];

const loserMapping = [
  // Runde 1: 4 Matches
  [{row:1,col:0},{row:1,col:1},{row:1,col:2},{row:1,col:3}]
];

// Bracket laden
fetch(SHEET_URL)
  .then(res => res.text())
  .then(csv => {
    const data = parseCSV(csv);
    generateBracket(document.getElementById("winner-bracket"), data, winnerMapping);
    generateBracket(document.getElementById("loser-bracket"), data, loserMapping);
  })
  .catch(err => console.error("Fehler beim Laden der Daten:", err));
</script>

</body>
</html>
